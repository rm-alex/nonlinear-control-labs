\documentclass[a4paper,14pt]{extarticle}

\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english, russian]{babel}

\usepackage[left=30mm, right=10mm, top=20mm, bottom=20mm]{geometry}

\usepackage{tempora}
\usepackage{setspace}
\onehalfspacing

\usepackage{titlesec}
\titleformat{\section}[block]{\bfseries\centering\MakeUppercase}{\thesection.}{1em}{}
\titleformat{\subsection}[block]{\bfseries}{\thesubsection.}{1em}{}
\titleformat{\subsubsection}[block]{\bfseries}{\thesubsubsection.}{1em}{}

\renewcommand{\contentsname}{\hfill \textbf{СОДЕРЖАНИЕ} \hfill\null}

\usepackage{indentfirst}
\setlength{\parindent}{1.25cm}

\usepackage{amsmath, amsfonts, amssymb}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{float}
\usepackage{tikz}
\usetikzlibrary{patterns}
\usepackage{cmap}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{listings}

\definecolor{LightGray}{gray}{0.7}

\lstdefinestyle{code}{
    language=Python, % change if needed
    basicstyle=\small\ttfamily,
    numbers=left,
    numberstyle=\small\color{LightGray},
    stepnumber=1,
    numbersep=5pt,
    backgroundcolor=\color{white},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=4,
    captionpos=b,
    breaklines=true,
    breakatwhitespace=false,
    frame=single,
    rulecolor=\color{LightGray},
    linewidth=\linewidth,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{green!40!black},
    stringstyle=\color{violet},
    escapeinside={\%*}{*)},
    xleftmargin=10pt,
    xrightmargin=10pt,
    framexleftmargin=0pt,
    framexrightmargin=0pt
}
\lstset{style=code}

\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,
    urlcolor=cyan,
    pdftitle={GOST report template},
    pdfauthor={Rumyantsev Alexey},
    pdfsubject={report subject},
    pdfkeywords={LaTeX, PDF},
    pdfpagemode=FullScreen,
}

\graphicspath{{src/images/}}

\begin{document}

\begin{titlepage}
    \begin{center}
        МИНИСТЕРСТВО НАУКИ И ВЫСШЕГО ОБРАЗОВАНИЯ РОССИЙСКОЙ ФЕДЕРАЦИИ\\
        \vspace*{2.5mm}
        Федеральное государственное автономное образовательное учреждение высшего образования
        «НАЦИОНАЛЬНЫЙ ИССЛЕДОВАТЕЛЬСКИЙ УНИВЕРСИТЕТ ИТМО»\\
        \vspace*{2.5mm}
        \textbf{ФАКУЛЬТЕТ СИСТЕМ УПРАВЛЕНИЯ И РОБОТОТЕХНИКИ}
        \vfill

        {\large ОТЧЕТ ПО ЛАБОРАТОРНОЙ РАБОТЕ №1}\\
        {\large по дисциплине}\\
        {\large\bfseries «НЕЛИНЕЙНЫЕ СИСТЕМЫ УПРАВЛЕНИЯ»}\\
        {\large на тему}\\
        {\large\bfseries «АНАЛИЗ И СТАБИЛИЗАЦИЯ НЕЛИНЕЙНЫХ ДИНАМИЧЕСКИХ СИСТЕМ»}\\
        \vfill

        \begin{flushright}
            Выполнил: студент гр. R3441\\
            Румянцев А. А.\medskip\\

            Проверил: преподаватель\\
            Зименко К. А.
        \end{flushright}

        \vfill

        Санкт-Петербург\\
        2025
    \end{center}
\end{titlepage}

\setcounter{page}{2}
\tableofcontents
\newpage

\section{Задание 1}
\subsection{Условие}
Для каждой из данных систем найти все точки равновесия.
На основе метода линеаризации в точке определить тип каждого
изолированного состояния равновесия. С использованием перехода
к полярным координатам определить устойчивость предельного
цикла для системы 4.


Численно построить фазовый портрет каждой системы и сравнить с полученными
результатами (кроме системы 7).


\subsection{Выполнение}
\subsubsection{Первая система}
Найдем точки равновесия системы (\ref{syseq:1})
\begin{align}
\begin{cases}
    \dot{x}_1=-x_1+2x_1^3+x_2,\\
    \dot{x}_2=-x_1-x_2
\end{cases}\label{syseq:1}
\end{align}


Приравняем выражения к нулю
и найдем корни системы
$$
\begin{cases}
    -x_1+2x_1^3+x_2=0,\\
    -x_1-x_2=0
\end{cases}\Rightarrow
\begin{cases}
    x_1=-x_2,\\
    x_2\left( 1-x_2^2 \right)=0
\end{cases}\Rightarrow
\left[
\begin{matrix}
    \left( 0;0 \right),\\
    \left( 1;-1 \right),\\
    \left( -1;1 \right)
\end{matrix}
\right.
$$


Определим тип каждого изолированного состояния равновесия.


Составим матрицу Якоби
$$
J=\dfrac{\partial f}{\partial x}=\begin{bmatrix}
    \dfrac{\partial \dot{x}_1}{\partial x_1} &\dfrac{\partial \dot{x}_1}{\partial x_2}\\
    \dfrac{\partial \dot{x}_2}{\partial x_1} &\dfrac{\partial \dot{x}_2}{\partial x_2}\\
\end{bmatrix}=
\begin{bmatrix}
    6x_1^2-1 &1\\
    -1 &-1
\end{bmatrix}
$$


Найдем матрицы $A_i$ и их собственные числа
$$
A_1=J|_{\left( 0;0 \right)}=\begin{bmatrix}
    -1 &1\\
    -1 &-1
\end{bmatrix},\ \lambda_{A_1\, 1,2}=\left\{ -1\pm i \right\},
$$
$$
A_2=J|_{\left( 1;-1 \right)}=\begin{bmatrix}
    5 &1\\
    -1 &-1
\end{bmatrix},\ \lambda_{A_2\, 1,2}=\left\{4.8284, -0.8284\right\},
$$
$$
A_3=J|_{\left( -1;1 \right)}=\begin{bmatrix}
    5 &1\\
    -1 &-1
\end{bmatrix},\ \lambda_{A_3\, 1,2}=\lambda_{A_2\, 1,2}
$$


Таким образом, 
\begin{align*}
    &(0;0):\lambda_{A_1\, 1,2}=\left\{ -1\pm i \right\} \text{ -- устойчивый фокус},\\
    &(1;-1),(-1;1):\lambda_{A_{2,3}\, 1,2}=\left\{4.8284, -0.8284\right\} \text{ -- седло}
\end{align*}


Седловые точки находятся рядом с устойчивым фокусом,
из-за чего некоторые фазовые траектории будут уходить на бесконечность
вдоль седловых направлений.


Таким образом, любой контур вокруг фокуса не может
полностью замкнуться, а значит предельного цикла не существует.


Численно построим фазовый портрет системы.


\begin{figure}[H]
    \centering
    \includegraphics[scale=0.75]{pps1.png}
    \caption{Фазовый портрет системы (\ref{syseq:1})}
    \label{fig:pps1}
\end{figure}


Точки равновесия совпадают с найденными ранее.
На графике получились устойчивый фокус и два седла.


\subsubsection{Вторая система}
Рассмотрим систему (\ref{syseq:2})
\begin{align}
    \begin{cases}
        \dot{x}_1=x_1+x_1x_2,\\
        \dot{x}_2=-x_2+x_2^2+x_1x_2-x_1^3
    \end{cases}\label{syseq:2}
\end{align}


Проведем аналогичные действия
$$\begin{cases}
    x_1+x_1x_2=0,\\
    -x_2+x_2^2+x_1x_2-x_1^3=0
\end{cases}\Rightarrow\begin{cases}
    x_1\left( x_2+1 \right)=0,\\
    -x_2-x_2^2+x_1x_2-x_1^3=0
\end{cases}$$


Получим две системы
$$
\begin{cases}
    x_1=0,\\
    x_2\left( x_2-1 \right)=0
\end{cases}\vee \ \ \ \begin{cases}
    x_2=-1,\\
    x_1^3+x_1-2=0
\end{cases}
$$


Решая первую систему, получим
$$
\begin{cases}
    x_1=0,\\
    x_2=0
\end{cases}\vee \ \ \ \begin{cases}
    x_1=0,\\
    x_2=1
\end{cases}
$$


Подставив $x_1=1$ во вторую систему, получим равенство нулю.
После деления полинома $x_1^3+x_1-2$ на $x_1-1$ получим
$$
\begin{cases}
    x_2=-1,\\
    \left( x_1-1 \right)\left( x_1^2+x_1+2 \right)=0
\end{cases}
$$


Второе выражение даст комплексные корни. Для анализа
системы и построения фазовых портретов берем только вещественные, тогда
$$
\begin{cases}
    x_1=1,\\
    x_2=-1
\end{cases}
$$


Таким образом, имеем точки равновесия системы
$$
\left[
\begin{matrix}
    \left( 0;0 \right),\\
    \left( 0;1 \right),\\
    \left( 1;-1 \right)
\end{matrix}
\right.
$$


Составим матрицу Якоби
$$
J=\dfrac{\partial f}{\partial x}=\begin{bmatrix}
    x_2+1 &x_1\\
    -3x_1^2+x_2 &x_1+2x_2-1
\end{bmatrix}
$$


Найдем матрицы $A_i$ и их собственные числа
$$
A_1=J|_{\left( 0;0\right)}=\begin{bmatrix}
    1 &0\\
    0 &-1
\end{bmatrix},\ \lambda_{A_1\,1,2}=\left\{ -1,1 \right\},
$$
$$
A_2=J|_{\left( 0;1\right)}=\begin{bmatrix}
    2 &0\\
    1 &1
\end{bmatrix},\ \lambda_{A_2\,1,2}=\left\{ 1,2 \right\},
$$
$$
A_3=J|_{\left( 1;-1\right)}=\begin{bmatrix}
    0     &1\\
    -4    &-2
\end{bmatrix},\ \lambda_{A_3\,1,2}=\left\{ -1 \pm 1.7321i \right\}
$$


Таким образом,
\begin{align*}
    &\left( 0;0 \right):\lambda_{A_1\,1,2}=\left\{ -1,1 \right\}\text{ -- седло},\\
    &\left( 0;1 \right):\lambda_{A_2\,1,2}=\left\{ 1,2 \right\}\text{ -- неустойчивый узел},\\
    &\left( 1;-1 \right):\lambda_{A_3\,1,2}=\left\{ -1 \pm 1.7321i \right\}\text{-- устойчивый фокус}
\end{align*}


Численно построим фазовый портрет системы.


\begin{figure}[H]
    \centering
    \includegraphics[scale=0.75]{pps2.png}
    \caption{Фазовый портрет системы (\ref{syseq:2})}
    \label{fig:pps2}
\end{figure}


Точки равновесия совпадают с найденными ранее.
На графике получились седло, неустойчивый узел и устойчивый фокус.


\subsubsection{Третья система}
Рассмотрим систему:
\begin{align}
\begin{cases}
    \dot{x}_1=x_2,\\
    \dot{x}_2=-x_1+x_2\left( 1-x_1^2 +0.1x_1^4\right)
\end{cases}   \label{syseq:3} 
\end{align}


Точки равновесия:
$$
\begin{cases}
    x_2=0,\\
    -x_1=0
\end{cases}\Rightarrow
\begin{matrix}
    \left( 0;0 \right)
\end{matrix}
$$


Матрица Якоби:
$$
J=\begin{bmatrix}
    0 &1\\
    -1+x_2\left( -2x_1+0.4x_1^3 \right) &1-x_1^2+0.1x_1^4
\end{bmatrix}
$$


Матрица $A$ и ее собственные числа:
$$
A=J|_{\left( 0;0 \right)}=\begin{bmatrix}
    0&1\\
    -1&1
\end{bmatrix},\ \lambda_{1,2}=\left\{ 0.5 \pm 0.866i \right\}
$$


Вывод: неустойчивый фокус. Действительная часть мнимной пары
больше нуля.


Фазовый портрет:
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.75]{pps3.png}
    \caption{Фазовый портрет системы (\ref{syseq:3})}
    \label{fig:pps3}
\end{figure}


Точка равновесия совпадает с найденной ранее. На портрете неустойчивый фокус.


\subsubsection{Четвертая система}
Рассмотрим систему:
\begin{align}
    \begin{cases}
        \dot{x}_1=\left( x_1-x_2 \right)\left( 1-x_1^2-x_2^2 \right),\\
        \dot{x}_2=\left( x_1+x_2 \right)\left( 1-x_1^2-x_2^2 \right)
    \end{cases}\label{syseq:4}
\end{align}


Сделаем замену $r^2=x_1^2+x_2^2$, тогда:
$$
\begin{cases}
    \dot{x}_1=\left( x_1-x_2 \right)\left( 1-r^2 \right),\\
        \dot{x}_2=\left( x_1+x_2 \right)\left( 1-r^2 \right)
\end{cases}
$$


Найдем точки равновесия:
$$
\begin{cases}
    \left( x_1-x_2 \right)\left( 1-r^2 \right)=0,\\
    \left( x_1+x_2 \right)\left( 1-r^2 \right)=0
\end{cases}
$$


Рассмотрим случай $1-r^2\neq0$:
$$
\begin{cases}
    1-r^2\neq0,\\
    x_1-x_2=0,\\
    x_1+x_2=0
\end{cases}\Rightarrow\begin{cases}
    x_1=x_2,\\
    x_2=-x_2
\end{cases}\Rightarrow
\begin{matrix}
    \left( 0;0 \right)
\end{matrix}
$$


Рассмотрим случай $1-r^2=0$:
$$
\begin{cases}
    1-r^2=0,\\
    x_1-x_2\neq0,\\
    x_1+x_2\neq0
\end{cases}\Rightarrow\begin{cases}
    r=1\ \left( \sum x_i^2\neq-1 \right),\\
    x_1^2+x_2^2=1
\end{cases}\Rightarrow\left\{ \left( x_1,x_2 \right)|\, x_1^2+x_2^2=1 \right\}
$$


В случае $1-r^2=0$ единичная окружность является множеством равновесий.


Матрица Якоби:
$$
J=\begin{bmatrix}
    -2x_1^2-\left( x_1-x_2 \right)^2+1&2x_2^2+\left( x_1-x_2 \right)^2-1\\
    -2x_1^2-\left( x_1+x_2 \right)^2+1&-2x_2^2-\left( x_1+x_2 \right)^2+1
\end{bmatrix}
$$


Матрица $A$ и ее собственные числа:
$$
A=J|_{\left(0;0\right)}=\begin{bmatrix}
    1&-1\\
    1&1
\end{bmatrix},\ \lambda_{1,2}=\left\{ 1\pm i \right\}
$$


Таким образом, в точке равновесия $\left( 0;0 \right)$
неустойчивый фокус. Действительная часть комплексной пары
больше нуля.


Для поиска предельного цикла перейдем к полярным координатам:
$$
r=\sqrt{x_1^2+x_2^2},\ \ \theta=\arctan{\dfrac{x_2}{x_1}},\ \
\begin{cases}
    x_1=r\cos{\theta},\\
    x_2=r\sin{\theta}
\end{cases}
$$


Приведем систему (\ref{syseq:4}) к виду:
$$
\dot{r}=\dfrac{x_1\dot{x}_1+x_2\dot{x}_2}{r}
$$
Эта формула получается при взятии производной от
выражения $r$ с корнем.


Домножим оба выражения на недостающие $x_i$:
$$
\begin{cases}
    \dot{x}_1=\left( x_1-x_2 \right)\left( 1-r^2 \right) |\cdot x_1,\\
    \dot{x}_2=\left( x_1+x_2 \right)\left( 1-r^2 \right) |\cdot x_2
\end{cases}\Rightarrow\begin{cases}
    x_1\dot{x}_1=x_1\left( x_1-x_2 \right)\left( 1-r^2 \right),\\
    x_2\dot{x}_2=x_2\left( x_1+x_2 \right)\left( 1-r^2 \right)
\end{cases}
$$


Сложим два выражения, вынесем общий множитель и упростим:
$$
x_1\dot{x}_1+x_2\dot{x}_2=\left( x_1\left( x_1-x_2 \right)+x_2\left( x_1+x_2 \right) \right)\left( 1-r^2 \right),
$$
$$
\left( x_1\left( x_1-x_2 \right)+x_2\left( x_1+x_2 \right) \right)\left( 1-r^2 \right)
=\left( x_1^2+x_2^2 \right)\left( 1-r^2 \right)=r^2\left( 1-r^2 \right)
$$


Разделим на $r$ и получим:
$$
\dot{r}=\dfrac{x_1\dot{x}_1+x_2\dot{x}_2}{r}=r\left( 1-r^2 \right)
$$


Аналогично выведем производную полярного угла:
$$
\dot{\theta}=\dfrac{x_1\dot{x}_2-x_2\dot{x}_1}{r^2}
$$
Эта формула получается при взятии производной от выражения $\theta$
с арктангенсом.


Приведем систему:
$$
\begin{cases}
    \dot{x}_1=\left( x_1-x_2 \right)\left( 1-r^2 \right) |\cdot (-x_2),\\
    \dot{x}_2=\left( x_1+x_2 \right)\left( 1-r^2 \right) |\cdot x_1
\end{cases}\Rightarrow\begin{cases}
    -x_2\dot{x}_1=-x_2\left( x_1-x_2 \right)\left( 1-r^2 \right),\\
    x_1\dot{x}_2=x_1\left( x_1+x_2 \right)\left( 1-r^2 \right)
\end{cases}
$$
$$
x_1\dot{x}_2-x_2\dot{x}_1=\left( x_1\left( x_1+x_2 \right)-x_2\left( x_1-x_2 \right) \right)\left( 1-r^2 \right)=r^2\left( 1-r^2 \right)
$$


Разделим на $r^2$ и получим:
$$
\dot{\theta}=\dfrac{x_1\dot{x}_2-x_2\dot{x}_1}{r^2}=1-r^2
$$


Фазовый портрет:
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.75]{pps4.png}
    \caption{Фазовый портрет системы (\ref{syseq:4})}
    \label{fig:pps4}
\end{figure}


Точка равновесия совпадает с найденной ранее.
На портрете есть предельный цикл -- окружность радиуса 1.


\subsubsection{Пятая система}
Рассмотрим систему:
\begin{align}
    \begin{cases}
        \dot{x}_1=-x_1^3+x_2,\\
        \dot{x}_2=x_1-x_2^3
    \end{cases}\label{syseq:5}
\end{align}


Фазовый портрет:
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.75]{pps5.png}
    \caption{Фазовый портрет системы (\ref{syseq:5})}
    \label{fig:pps5}
\end{figure}


Точки равновесия совпадают с найденными ранее.


\subsubsection{Шестая система}
Рассмотрим систему:
\begin{align}
    \begin{cases}
        \dot{x}_1=-x_1^3+x_2^3,\\
        \dot{x}_2=x_2^3x_1-x_2^3
    \end{cases}\label{syseq:6}
\end{align}


Фазовый портрет:
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.75]{pps6.png}
    \caption{Фазовый портрет системы (\ref{syseq:6})}
    \label{fig:pps6}
\end{figure}


Точки равновесия совпадают с найденными ранее.


\subsubsection{Седьмая система}
Рассмотрим систему:
\begin{align}
    \begin{cases}
        \dot{x}_1=-x_1^3+x_2^3,\\
        \dot{x}_2=x_1+3x_3-x_2^3,\\
        \dot{x}_3=x_1x_3-x_2^3-\sin{x_1}
    \end{cases}\label{syseq:7}
\end{align}


\section{Задание 2}
\subsection{Условие}
Для каждой из данных систем найти все изолированные
точки равновесия и построить локально стабилизирующий
регулятор.


Представить результаты численного моделирования.


\subsection{Выполнение}
\subsubsection{Первая система}
...


\subsubsection{Вторая система}
...


\section{Вывод}
...

% \appendix
% \renewcommand{\thesection}{\Asbuk{section}}

% \section{Приложение}

\end{document}
